{% extends "base.html" %}
{% load i18n %}
{% load allauth %}
{% block head_title %}
{% trans "Change Password" %}
{% endblock head_title %}

{% block content %}

<div class="container">
    <div class="row">
        <div class="col-md-8 mt-3 offset-md-2">
            {% if token_fail %}
            <h3>Bad Token</h3>
            {% else %}
            <h3>Change Password</h3>
            {% endif %}
            {% if token_fail %}
            {% url 'account_reset_password' as passwd_reset_url %}
            <p>The password reset link was invalid, possibly because it has already been used. Please request a <a
                    href="{{ passwd_reset_url }}">new password reset</a>.</p>
            {% endif %}
        </div>
    </div>


    {% if not token_fail %}
    <div class="row">
        <div class="col-md-8 mt-3 offset-md-2">
            <form method="post" action="{{ action_url }}">
                {% csrf_token %}
                {{ redirect_field }}
                {{ form.as_p }}
                <button class="button" type="submit" name="action">Change Password</button>
                <button class="button" type="submit" form="logout-from-stage" tags="link,cancel">Cancel</button>
            </form>
        </div>
    </div>
    {% endif %}

    {% if not cancel_url %}
    <form id="logout-from-stage" method="post" action="{% url 'account_logout' %}">
        <input type="hidden" name="next" value="{% url 'account_login' %}">
        {% csrf_token %}
    </form>
    {% endif %}
</div>
{% endblock content %}